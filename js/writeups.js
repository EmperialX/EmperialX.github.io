class WriteupManager{constructor(){this.writeups=[],this.categories=[],this.currentCategory="all",this.csrfToken=document.querySelector('meta[name="csrf-token"]')?.content}async loadWriteups(){try{const e=await fetch("/data/writeups.json",{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-Token":this.csrfToken},credentials:"same-origin"});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();if(!this.validateData(t))throw new Error("Invalid data structure");this.writeups=t.writeups,this.categories=t.categories,this.renderWriteups(),this.setupCategoryFilters()}catch(e){console.error("Error loading writeups:",e),this.handleError("Failed to load writeups")}}validateData(e){return e&&Array.isArray(e.categories)&&Array.isArray(e.writeups)&&e.writeups.every(this.validateWriteup)}validateWriteup(e){return e&&"string"==typeof e.id&&"string"==typeof e.title&&"string"==typeof e.category&&"string"==typeof e.date&&"string"==typeof e.summary&&Array.isArray(e.tools)&&Array.isArray(e.tags)&&"string"==typeof e.url&&/^https?:\/\/[^\s/$.?#].[^\s]*$/.test(e.url)&&(e.url.includes("medium.com")||e.url.includes("github.com"))}sanitizeHTML(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}formatDate(e){try{const t=new Date(e);if(isNaN(t.getTime()))throw new Error("Invalid date");return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(e){return console.error("Invalid date:",e),"Invalid date"}}createWriteupCard(e){const t=this.sanitizeHTML(e.title),r=this.sanitizeHTML(e.category),a=this.sanitizeHTML(e.summary),s=this.sanitizeHTML(e.type),i=e.tools.map((e=>this.sanitizeHTML(e))),n=this.validateURL(e.url);return`\n            <article class="writeup-card glass-card" data-category="${r}">\n                <div class="writeup-header">\n                    <span class="tag">${r}</span>\n                    <h3>${t}</h3>\n                    <div class="writeup-meta">\n                        <span class="date">\n                            <i class="far fa-calendar"></i> \n                            ${this.formatDate(e.date)}\n                        </span>\n                        <span class="type">\n                            <i class="fas fa-bookmark"></i> ${s}\n                        </span>\n                    </div>\n                </div>\n                <div class="writeup-content">\n                    <p class="summary">${a}</p>\n                    <div class="tools-used">\n                        ${i.map((e=>`<span>${e}</span>`)).join("")}\n                    </div>\n                </div>\n                <div class="card-footer">\n                    <a href="${n}" \n                       class="read-more" \n                       target="_blank" \n                       rel="noopener noreferrer">\n                        Read on ${n.includes("medium.com")?"Medium":n.includes("github.com")?"GitHub":"External Site"}\n                        <i class="fas fa-external-link-alt"></i>\n                    </a>\n                </div>\n            </article>\n        `}validateURL(e){try{const t=new URL(e);if(!["medium.com","github.com"].some((e=>t.hostname.includes(e))))throw new Error("Invalid domain");return t.href}catch(e){return console.error("Invalid URL:",e),"#"}}handleError(e){const t=document.querySelector(".writeups-showcase");t&&(t.innerHTML=`\n                <div class="error-message">\n                    <i class="fas fa-exclamation-triangle"></i>\n                    ${this.sanitizeHTML(e)}\n                </div>\n            `)}renderWriteups(e="all"){const t=document.querySelector(".writeups-showcase");if(!t)return;const r="all"===e?this.writeups:this.writeups.filter((t=>t.category===e));t.innerHTML=r.map((e=>this.createWriteupCard(e))).join("")}setupCategoryFilters(){const e=document.querySelector(".writeup-categories");if(!e)return;const t=["all",...this.categories].map((e=>`\n                <button class="category-btn ${"all"===e?"active":""}" \n                        data-category="${e}">\n                    ${e.charAt(0).toUpperCase()+e.slice(1)}\n                </button>\n            `)).join("");e.innerHTML=t,e.querySelectorAll(".category-btn").forEach((t=>{t.addEventListener("click",(()=>{e.querySelectorAll(".category-btn").forEach((e=>e.classList.remove("active"))),t.classList.add("active"),this.currentCategory=t.dataset.category,this.renderWriteups(this.currentCategory)}))}))}}document.addEventListener("DOMContentLoaded",(()=>{try{(new WriteupManager).loadWriteups()}catch(e){console.error("Failed to initialize WriteupManager:",e)}}));